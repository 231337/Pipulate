<html>
  <head>
    <title>Pipulate Free and Open Source SEO Software</title>
    <meta name="description" content="Pipulate Collects Data directly into Spreadsheets for SEO and Social Media monitoring.">
    <meta name="viewport" content="width=device-width, initial-scale=.90">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Paytone+One' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Nunito:300' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="http://www.picnicss.com/nut/picnic_3_2+nav_2+stack.min.fresh.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./static/css/mikelevin.css">
    <link rel="stylesheet" href="./static/css/animation.css"><!--[if IE 7]><link rel="stylesheet" href="css/mikelevin-ie7.css"><![endif]-->
    <style>
    @font-face {
      font-family: 'mikelevin';
      src: url('./static/font/mikelevin.eot?58372708');
      src: url('./static/font/mikelevin.eot?58372708#iefix') format('embedded-opentype'),
           url('./static/font/mikelevin.woff?58372708') format('woff'),
           url('./static/font/mikelevin.ttf?58372708') format('truetype'),
           url('./static/font/mikelevin.svg?58372708#mikelevin') format('svg');
      font-weight: normal;
      font-style: normal;
    }
    body {
      font-family: Nunito;
      font-size: 15px;
      color: #333;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    .pip {
      font-family: Paytone One;
    }
    #wrapper {
      position: relative;
      height: 100%;
    }
    #content{
      background-color: #000;
      position: relative;
      margin: 0 auto;
      padding-left: 5px;
      padding-right: 5px;
      padding-top: 60px;
      text-align:center;
      min-height: 100%
    }
    #pipstream{
      border: 2px solid lightgrey;
      height: 305px;
      overflow: auto;
      background-color: white;
      margin-bottom: 15px;
      margin-left:15px;
      margin-right:15px;
      padding-top: 5px;
      padding-bottom: 5px;
      padding-left: 5px;
      text-align: left;
      line-height: 1.4em;
    }
    .pl {
      font-size: .9em;
    }
    nav{
      background-color:#EEEEEE;
    }
    #magicdiv{
      margin-top: 15px;
      margin-bottom: 6px;
      margin-left: 15px;
      margin-right: 14px;
      text-align:center;
    }
    #learnsomething{
      background-color: lightgrey;
      margin-bottom: 0px;
      margin-left: auto;
      margin-right: auto;
      margin-bottom: 0px;
      line-height: 2.7;
      width: 100%;
      height: 38px;
    }
    #magicbox{
      -webkit-border-radius:0px;
      border-radius:0px;
      border: 2px solid lightgrey;
      margin-top: 0px;
      margin-left: auto;
      margin-right:auto;
      width: 100%;
      -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
      -moz-box-sizing: border-box;    /* Firefox, other Gecko */
      box-sizing: border-box;         /* Opera/IE 8+ */
    }
    #pipulate{font-family:Paytone One}
    #pipurl{margin-bottom:14px}
    #paste{
      width: 95%;
      white-space:nowrap;
      margin-left: auto;
      margin-right: auto;
      padding-right: 75px;
    }
    #pastelabel{
      white-space:nowrap;
      font-size: 1.3em;
      text-align: right;
      color: white;
    }
    .spinner {
      margin-top: 40px;
      margin-left: auto;
      margin-right:auto;
      width: 70px;
      position: absolute;
      line-height: 6.5;
      left: 0;
      right: 0;
    }
    .spinner > div {
      width: 18px;
      height: 18px;
      background-color: #C6C6C6;
      border-radius: 100%;
      display: inline-block;
      -webkit-animation: bouncedelay 1.4s infinite ease-in-out;
      animation: bouncedelay 1.4s infinite ease-in-out;
      /* Prevent first frame from flickering when animation starts */
      -webkit-animation-fill-mode: both;
      animation-fill-mode: both;
    }
    .spinner .bounce1 {
      -webkit-animation-delay: -0.32s;
      animation-delay: -0.32s;
    }
    .spinner .bounce2 {
      -webkit-animation-delay: -0.16s;
      animation-delay: -0.16s;
    }
    @-webkit-keyframes bouncedelay {
      0%, 80%, 100% { -webkit-transform: scale(0.0) }
      40% { -webkit-transform: scale(1.0) }
    }
    @keyframes bouncedelay {
      0%, 80%, 100% { 
        transform: scale(0.0);
        -webkit-transform: scale(0.0);
      } 40% { 
        transform: scale(1.0);
        -webkit-transform: scale(1.0);
      }
    }
    #arrow{
      font-weight: bold;
      font-size: 1.8em;
      color: #323232;
      position : relative;
      top:.2em;
    }
    #drag{
      font-size: 1em;
      position : relative;
      top:.1em;
      white-space: nowrap;
    }
    #piplogo {
      max-width: 380px;
      position: relative;
      top: 40%;
      transform: translateY(-50%);
    }
    .bookmarklet{padding: 0px;}
    .pressthis{
      margin:5px 40px 8px 5px;
      float: left;
      }
    .pressthis a,.pressthis a:active,.pressthis a:focus,.pressthis a:hover{
      padding:3px;
      display:inline-block;
      position:relative;cursor:
      move;color:#333;
      background:#e6e6e6;
      -webkit-border-radius:5px;
      border-radius:5px;
      border:1px solid #b4b4b4;
      font-family:Paytone One;
      font-size:16px;
      text-decoration:none}
    .pressthis a:active{
      outline:0}
    .pressthis a:hover:after{
      -webkit-transform:skew(20deg) rotate(9deg);
      -ms-transform:skew(20deg) rotate(9deg);
      transform:skew(20deg) rotate(9deg);
      -webkit-box-shadow:0 10px 8px rgba(0,0,0,.7);
      box-shadow:0 10px 8px rgba(0,0,0,.7)}
    .pressthis a span{
      display:inline-block;
      margin-left:25px;
      margin-right:26px;
      }
    .pressthis a span:
      before{color:#777;
      font:400 20px/1 ;
      position:relative;
      display:inline-block;
      top:4px;
      margin-right:4px}
    .pressthis a:after{
      content:'';
      width:70%;
      height:55%;
      z-index:-1;
      position:absolute;
      right:10px;
      bottom:9px;
      background:0 0;
      -webkit-transform:skew(20deg) rotate(6deg);
      -ms-transform:skew(20deg) rotate(6deg);
      transform:skew(20deg) rotate(6deg);
      -webkit-box-shadow:0 10px 8px rgba(0,0,0,.6);
      box-shadow:0 10px 8px rgba(0,0,0,.6)}

    .pip-icon
    {
      font-family: "mikelevin";
      font-style: normal;
      font-weight: normal;
      speak: none;
     
      display: inline-block;
      text-decoration: inherit;
      width: 1em;
      margin-right: 1em;
      text-align: center;
      /* opacity: .8; */
     
      /* For safety - reset parent styles, that can break glyph codes*/
      font-variant: normal;
      text-transform: none;
     
      /* fix buttons height, for twitter bootstrap */
      line-height: 1em;
     
      /* Animation center compensation - margins should be symmetric */
      /* remove if not needed */
      margin-left: .2em;
     
      /* You can be more comfortable with increased icons size */
      /* font-size: 120%; */
     
      /* Font smoothing. That was taken from TWBS */
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
     
      /* Uncomment for 3D effect */
      /* text-shadow: 1px 1px 1px rgba(127, 127, 127, 0.3); */
    }
    .pipmenu {
      background-color:#DDDDDD;
      width: 115px;
      height: 2.1em;
    }
    #piphelp {
      position:absolute;
      right: 3em;
      margin-top:14px;
      font-size: 1.2em;
      color: black;
    }
    @media (max-width: 500px) {
      #drag {
        display: none;
      }
    }
    @media (min-width: 960px) {
      #pastelabel{
        width:4em;
      }
      #paste{
        width: 97%;
        margin-left: auto;
        margin-right: auto;
        margin-top:50px;
      }
      .pip {
        margin-top: 50px;
      }
      #piphelp{
        right: auto;
      }
    }
    </style>

    <script>
      function redlock() {
        $('#piplock').css('color', 'red');
      }
      function whitelock() {
        $('#piplock').css('color', 'white');
      }
      function lockbutton() {
        $('#pipulate').fadeTo(0,.5);
        $('#pipulate').prop("disabled", true);
        $('#piplock').removeClass("fa-chevron-circle-right");
        $('#piplock').addClass("fa-lock");
      }
      function unlockbutton() {
        whitelock();
        $('#pipulate').prop("disabled", false);
        $('#pipulate').fadeTo("fast",1);
        $('#piplock').addClass("fa-chevron-circle-right");
        $('#piplock').removeClass("fa-lock");
      }
      $(document).ready(function(){  
        {% if request.method == 'GET': %}
          $("#spinner").hide();
        {% elif form.pipurl.data == '': %}
          $("#spinner").hide();
          unlockbutton();
          $("#learnsomething").html('Copy and paste Google Spreadsheet URL into URL field.');
        {% endif %}
        $("#pipulate").click(function() {
          lockbutton();
          $('#pipstream').html('');
          $('#spinner').show();
          $('#magicbox').val('');
          $('#learnsomething').html("Sit back and relax. I'm starting to pipulate...");
          $('#pipform').submit();
        });
      });
      if (location.hash) {
        var myhash = location.hash
        if (myhash.indexOf('access_token') > 0) {
          myhash = myhash.substring(1, myhash.length);
          window.location = "http://{{ request.headers['Host'] }}?" + myhash;
        }
      }
    </script>
  </head>
  <body>
    <div id="wrapper">
    <nav>
    <!-- responsive -->
    <input id="bmenu" type="checkbox" class="show">
    <label for="bmenu" class="burger"><i class="pip-icon pip-menu"></i></label>
    <div class="pressthis" style="text-align: center"><a class="bookmarklet" href="{{ bookmarklet }}" onclick="return false;" oncontextmenu="if(window.navigator.userAgent.indexOf('WebKit')!=-1||window.navigator.userAgent.indexOf('MSIE')!=-1){jQuery('.pressthis-code').show().find('textarea').focus().select();return false;}"><span>Pipulate</span></a> <img src="./static/foss-seo.png" style="vertical-align: middle;"/> <span id="drag">Drag to Boomarks Bar.</span></div>
    <a id="piphelp" class="pip-help-circled" href="./static/help.html"></a>
    <div class="menu">
      {% if session and 'loggedin' in session and session['loggedin'] == '1': %}
        <a class="button pip-block" href="{{ logoutlink }}">Logout</a>
      {% else %}
        <a class="button pip-googleplus" href="{{ loginlink }}">Login</a>
      {% endif %}
      <a class="button pip-play" target="_blank" href="https://docs.google.com/presentation/d/10lr_d1uyLMOnWsMzbenKiPlFE5-BIt9bxVucw7O4GSI/edit?usp=sharing">Intro &amp; Philosophy</a>
      <a class="button pip-github-1" target="_blank" href="https://github.com/miklevin/pipulate/blob/master/README.md">Documentation</a>
      <a class="button pip-youtube-play" target="_blank" href="https://www.youtube.com/playlist?list=PLy-AlqZFg6G_bo5bH_wLBdxx-TNfB_yXT">Video Tutorials</a>
      <a class="button pip-mikelevin-fatcircle" target="_blank" href="http://levinux.com">Levinux</a>
    </div>
    </nav>
    <div id="content">
      {% if session and 'loggedin' in session and session['loggedin'] == '1': %}
        <form id="pipform" method="POST" action="/">
          {{ form.mode(value=invokemode) }}
          <div id="centerme">
          <div id="paste" class="row"><span id="pastelabel">URL: </span>{{ form.pipurl(size=80) }}</div>
          </div>
          <div>
          {{ widget|safe }}
          <button id="pipulate" class="button" type="submit">
            {{ invokemode }} &nbsp;<i id="piplock" class="fa fa-chevron-circle-right"></i>
          </button>
          </div>
        </form>
        {% if request.method == 'POST': %}
          <script>
            lockbutton();
          </script>
        {% endif %}
        <div id="magicdiv">
          <div id="spinner" class="spinner">
            <div class="bounce1"></div>
            <div class="bounce2"></div>
            <div class="bounce3"></div>
          </div>
          {% if request.method == 'POST': %}
            <div id="learnsomething">First, we connect to Google Docs...</div>
          {% else %}
            <div id="learnsomething">{{ cyclemotto }}</div>
          {% endif %}
          <textarea id="magicbox" rows="4" cols="60"></textarea>
        </div>
        <div id="pipstream">
        {% with messages = get_flashed_messages() %}
          {% if messages %}
            {% for message in messages %}
              {%- if loop.index > 1: -%}<br/>{%- endif -%}<span class="pl"><i class="bullet fa fa-circle-o"></i> {{ message }}</span>
            {% endfor %}
          {% endif %}
        {% endwith %}
        {% for lineitem, learn, magic, glock in data: -%}
          {%- if glock == '+' : -%}
            <script>
              redlock();
            </script>
          {%- elif glock == '-': -%}
            <script>
              whitelock();
            </script>
          {%- endif -%}
          {%- if learn or magic: -%}
          <script>
            {%- if magic: -%}
              var pjson = {{ magic|safe }};
              //$("#magicbox").val(JSON.stringify(pjson, null, '\t'));
              $("#magicbox").val(JSON.stringify(pjson));
            {%- endif -%}
            {%- if learn: -%}$("#learnsomething").html('{{ learn }}');{%- endif -%}
          </script>
          {%- endif -%}
          {%- if lineitem -%}
            {%- if lineitem == "spinon" -%}
              <script>
                // Lock button and display spinner
                $('#pipulate').prop("disabled", true);
                $('#pipulate').fadeTo("fast",.5);
                //$('#spinner').show();
              </script>
            {%- elif lineitem == "spinoffsuccess" -%}
              <script>
                // Unlock button and remove spinner, successful pipulation
                $('#spinner').hide();
                $("i").removeClass("fa-spin fa-circle-o-notch");
                $("i").addClass("fa-check");
                document.write('<img id="pbjt" src="./static/pipulate.gif" style="vertical-align: top;">');
                unlockbutton();
              </script>
            {%- elif lineitem == "spinoff" -%}
              <script>
                // Unlock button and remove spinner, failed pipulation
                $('#spinner').hide();
                $("i").removeClass("fa-spin fa-circle-o-notch");
                $("i").addClass("fa-check");
                unlockbutton();
              </script>
            {%- elif lineitem == "spinerr" -%}
              <script>
                // Unlock button and gracefully show user things are fubar.
                $('#spinner').hide();
                $("i").removeClass("fa-spin fa-circle-o-notch");
                $("i.bullet").addClass("fa-circle-o");
                unlockbutton();
              </script>
            {%- elif lineitem[:1] == ',' -%}
              <span class="pl">{{ lineitem }}</span>
            {%- else -%}
              <script>
                $("i").removeClass("fa-spin fa-circle-o-notch");
                $("i").addClass("fa-check");
              </script>
              {%- if loop.index > 1: -%}<br/>{%- endif -%}<span class="pl"><i class="bullet fa fa-circle-o-notch fa-spin"></i> {{ lineitem|safe }}</span>
            {%- endif -%}
            <script>
              $("#pipstream").scrollTop($("#pipstream")[0].scrollHeight);
            </script>
          {%- endif -%}
        {%- endfor -%}
      {% else: %}
        <a class="button pip" href="{{ loginlink }}">LOGIN... &nbsp;<i id="piplock" class="pip-icon pip-googleplus"></i></a>
        <div style="height: 100%"><img id="piplogo" alt="Pipulate Free and Open Source SEO Software" src="static/pipulate-logo-white-transparent.png" /></div>
      {% endif %}
      </div>
    </div>
    </div>
  </body>
</html>
